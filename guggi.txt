<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>For My Guggi..</title> <!-- EXCEL: Page Title -->

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root {
    --deep-purple:#5e548e;
    --rose-pink:#ffafcc;
    --text-main:#231942;
}

body{
    margin:0;
    height:100vh;
    background:linear-gradient(to bottom right,#f3e7e9,#e3eeff);
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:'Poppins',sans-serif;
    overflow:hidden;
}

/* ENVELOPE */
#envelope-container{cursor:pointer;z-index:20}
.envelope{
    width:300px;height:200px;
    background:var(--deep-purple);
    border-radius:8px;
    display:flex;
    justify-content:center;
    align-items:center;
    position:relative;
}
.envelope::before{
    content:'';
    position:absolute;top:0;
    border-left:150px solid transparent;
    border-right:150px solid transparent;
    border-top:130px solid #7264a8;
    transition:transform .6s;
}
.envelope.open::before{transform:rotateX(180deg)}

.label{color:#fff;position:absolute;text-align:center;width:100%}
.top-text{top:45px;font-style:italic}
.bottom-text{bottom:30px;font-size:1.5rem;font-weight:700}

/* CARD */
#card-screen{
    display:none;
    flex-direction:column;
    text-align:center;
    background:rgba(255,255,255,.9);
    padding:30px;
    border-radius:20px;
}

.name-highlight{
    font-size:3rem;
    font-family:'Playfair Display',serif;
    background:linear-gradient(90deg,#5e548e,#ffafcc,#5e548e);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
}

/* BUTTONS */
.buttons-container{display:flex;gap:20px;margin-top:30px}
button{
    padding:15px 35px;
    border-radius:50px;
    font-weight:600;
    cursor:pointer;
}
#yesBtn{
    background:var(--deep-purple);
    color:#fff;
    border:none;
}
#noBtn{
    background:#fff;
    border:2px solid var(--deep-purple);
    color:var(--deep-purple);
}

/* FULLSCREEN YES */
.full-screen-yes{
    position:fixed!important;
    inset:0;
    font-size:2.5rem;
    display:flex;
    justify-content:center;
    align-items:center;
    background:linear-gradient(135deg,#5e548e,#ffafcc);
    color:#fff;
    z-index:9999;
}

/* SUCCESS */
#success-screen{
    display:none;
    background:#fff;
    padding:40px;
    border-radius:20px;
    text-align:center;
}

/* RAIN */
.rose{
    position:fixed;
    top:-40px;
    animation:fall linear forwards;
}
@keyframes fall{to{transform:translateY(110vh)}}
</style>
</head>

<body>

<!-- üéµ BACKGROUND MUSIC (EXCEL) -->
<audio id="bgMusic" loop>
    <source src="https://cdn.pixabay.com/download/audio/2024/01/16/audio_e2b992254f.mp3" type="audio/mpeg">
</audio>

<!-- üîä NO BUTTON ESCAPE SOUND (EXCEL) -->
<audio id="noEscapeSound">
    <source src="https://assets.mixkit.co/active_storage/sfx/2575/2575-preview.mp3" type="audio/mpeg">
</audio>

<!-- ENVELOPE -->
<div id="envelope-container">
    <div class="envelope" id="envelope">
        <div class="label top-text">For My Guggi..</div> <!-- EXCEL -->
        <div class="label bottom-text">From Abhi..</div> <!-- EXCEL -->
    </div>
</div>

<!-- CARD -->
<div id="card-screen">
    <h1>Will You Be My Forever Valentine??</h1> <!-- EXCEL -->
    <div class="name-highlight">Ankita</div> <!-- EXCEL -->

    <div class="buttons-container">
        <button id="yesBtn">Yes, I will</button> <!-- EXCEL -->
        <button id="noBtn">No</button> <!-- EXCEL -->
    </div>
</div>

<!-- SUCCESS -->
<div id="success-screen">
    <h1>Forever & Always üíú</h1> <!-- EXCEL -->
    <p><em>Yes Gugga, I'll be your Valentine!</em></p> <!-- EXCEL -->
    <div style="font-size:4rem">üíç</div> <!-- EXCEL -->
</div>

<script>
/* ELEMENTS */
const envelope=document.getElementById('envelope');
const envelopeContainer=document.getElementById('envelope-container');
const cardScreen=document.getElementById('card-screen');
const yesBtn=document.getElementById('yesBtn');
const noBtn=document.getElementById('noBtn');
const successScreen=document.getElementById('success-screen');
const bgMusic=document.getElementById('bgMusic');
const noEscapeSound=document.getElementById('noEscapeSound');

/* EXCEL CONFIG */
const noEscapeTexts = "No, Nope, Still No, Haha No, Okay Stop üò≠"
    .split(',').map(t=>t.trim());

const rainEmojis = "üå∏, üå∑, üíú, ü§ç, üíó, ‚ú®"
    .split(',').map(e=>e.trim());

let noClickCount=0;
let yesScale=1;

/* MUSIC */
document.body.addEventListener('click',()=>{
    bgMusic.volume=.5;
    bgMusic.play().catch(()=>{});
},{once:true});

/* OPEN ENVELOPE */
envelopeContainer.addEventListener('click',()=>{
    envelope.classList.add('open');
    setTimeout(()=>{
        envelopeContainer.style.display='none';
        cardScreen.style.display='flex';
    },800);
});

/* NO BUTTON ESCAPE */
function evadeNoButton(){
    noClickCount++;
    yesScale+=.2;

    noEscapeSound.currentTime=0;
    noEscapeSound.play().catch(()=>{});

    const maxX=window.innerWidth-noBtn.offsetWidth-20;
    const maxY=window.innerHeight-noBtn.offsetHeight-20;

    noBtn.style.position="fixed";
    noBtn.style.left=Math.random()*maxX+"px";
    noBtn.style.top=Math.random()*maxY+"px";

    noBtn.innerText=noEscapeTexts[Math.min(noClickCount-1,noEscapeTexts.length-1)];
    yesBtn.style.transform=`scale(${yesScale})`;

    if(noClickCount>=noEscapeTexts.length){
        yesBtn.classList.add('full-screen-yes');
        yesBtn.innerHTML="Okay, YES! üíú<br>(Click Me)";
        noBtn.style.display="none";
    }
}

noBtn.addEventListener('mouseenter',evadeNoButton);
noBtn.addEventListener('touchstart',evadeNoButton);

/* YES */
yesBtn.addEventListener('click',()=>{
    cardScreen.style.display='none';
    successScreen.style.display='block';
    setInterval(createRain,120);
});

/* RAIN */
function createRain(){
    const r=document.createElement('div');
    r.className='rose';
    r.innerText=rainEmojis[Math.floor(Math.random()*rainEmojis.length)];
    r.style.left=Math.random()*100+"vw";
    r.style.animationDuration=(Math.random()*3+3)+"s";
    r.style.fontSize=(Math.random()*15+15)+"px";
    document.body.appendChild(r);
    setTimeout(()=>r.remove(),6000);
}
</script>

</body>
</html>